# ğŸš€ åšå®¢ç½‘ç«™éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ å°†åšå®¢ç½‘ç«™éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. ç¡®ä¿ä»£ç å·²æ¨é€åˆ°Gitä»“åº“
```bash
git add .
git commit -m "å‡†å¤‡éƒ¨ç½²"
git push origin main
```

### 2. æ³¨å†Œå¿…è¦çš„æœåŠ¡è´¦æˆ·
- [Vercel](https://vercel.com) - å‰ç«¯éƒ¨ç½²
- [Railway](https://railway.app) - åç«¯éƒ¨ç½² + æ•°æ®åº“
- [Cloudflare](https://cloudflare.com) - åŸŸåç®¡ç†ï¼ˆå¯é€‰ï¼‰

---

## ğŸ¯ æ–¹æ¡ˆ1ï¼šæ¨èæ–¹æ¡ˆï¼ˆRailway + Vercelï¼‰

### æ­¥éª¤1ï¼šéƒ¨ç½²åç«¯åˆ°Railway

1. **åˆ›å»ºRailwayè´¦æˆ·å¹¶è¿æ¥GitHub**
   - è®¿é—® [Railway.app](https://railway.app)
   - ä½¿ç”¨GitHubè´¦æˆ·ç™»å½•
   - æˆæƒè®¿é—®ä½ çš„ä»“åº“

2. **åˆ›å»ºæ–°é¡¹ç›®**
   - ç‚¹å‡» "New Project"
   - é€‰æ‹© "Deploy from GitHub repo"
   - é€‰æ‹©ä½ çš„åšå®¢ä»“åº“
   - é€‰æ‹© `backend` æ–‡ä»¶å¤¹

3. **é…ç½®æ•°æ®åº“**
   - åœ¨é¡¹ç›®ä¸­ç‚¹å‡» "Add service"
   - é€‰æ‹© "Database" â†’ "PostgreSQL"
   - Railwayä¼šè‡ªåŠ¨æä¾›æ•°æ®åº“è¿æ¥URL

4. **è®¾ç½®ç¯å¢ƒå˜é‡**
   åœ¨Railwayé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ï¼š
   ```
   DATABASE_URL=<Railwayè‡ªåŠ¨ç”Ÿæˆçš„PostgreSQL URL>
   JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
   JWT_EXPIRES_IN=7d
   NODE_ENV=production
   FRONTEND_URL=https://your-vercel-domain.vercel.app
   ```

5. **éƒ¨ç½²**
   - Railwayä¼šè‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½²ä½ çš„åº”ç”¨
   - ç­‰å¾…éƒ¨ç½²å®Œæˆï¼Œè·å–åç«¯åŸŸåï¼ˆå¦‚ï¼š`https://your-backend.railway.app`ï¼‰

### æ­¥éª¤2ï¼šéƒ¨ç½²å‰ç«¯åˆ°Vercel

1. **åˆ›å»ºVercelè´¦æˆ·**
   - è®¿é—® [Vercel.com](https://vercel.com)
   - ä½¿ç”¨GitHubè´¦æˆ·ç™»å½•

2. **å¯¼å…¥é¡¹ç›®**
   - ç‚¹å‡» "New Project"
   - é€‰æ‹©ä½ çš„åšå®¢ä»“åº“
   - è®¾ç½®Root Directoryä¸º `frontend`

3. **é…ç½®ç¯å¢ƒå˜é‡**
   åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ï¼š
   ```
   NEXT_PUBLIC_API_URL=https://your-backend.railway.app
   NEXT_PUBLIC_SITE_NAME=æˆ‘çš„ä¸ªäººåšå®¢
   NEXT_PUBLIC_SITE_DESCRIPTION=åŸºäºNext.jsæ„å»ºçš„ç°ä»£åŒ–ä¸ªäººåšå®¢
   NEXT_PUBLIC_SITE_URL=https://your-vercel-domain.vercel.app
   ```

4. **éƒ¨ç½²**
   - ç‚¹å‡» "Deploy"
   - ç­‰å¾…éƒ¨ç½²å®Œæˆ

### æ­¥éª¤3ï¼šæ•°æ®åº“åˆå§‹åŒ–

1. **è¿è¡Œæ•°æ®åº“è¿ç§»**
   åœ¨Railwayåç«¯é¡¹ç›®ä¸­ï¼š
   - æ‰“å¼€é¡¹ç›®æ§åˆ¶å°
   - è¿è¡Œå‘½ä»¤ï¼š`npm run db:migrate`

2. **åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·**
   - è®¿é—®ä½ çš„å‰ç«¯ç½‘ç«™
   - æ³¨å†Œç¬¬ä¸€ä¸ªè´¦æˆ·
   - åœ¨Railwayæ•°æ®åº“ä¸­æ‰‹åŠ¨å°†è¯¥ç”¨æˆ·çš„roleæ”¹ä¸º 'ADMIN'

---

## ğŸ¯ æ–¹æ¡ˆ2ï¼šè‡ªæ‰˜ç®¡VPSéƒ¨ç½²

### å‡†å¤‡VPSæœåŠ¡å™¨

æ¨èé…ç½®ï¼š
- **CPU**: 1-2æ ¸
- **å†…å­˜**: 2-4GB
- **å­˜å‚¨**: 20-40GB SSD
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 22.04 LTS

æ¨èæœåŠ¡å•†ï¼š
- [DigitalOcean](https://digitalocean.com) - $5-10/æœˆ
- [Vultr](https://vultr.com) - $5-10/æœˆ
- [Linode](https://linode.com) - $5-10/æœˆ

### æœåŠ¡å™¨é…ç½®

1. **è¿æ¥æœåŠ¡å™¨**
   ```bash
   ssh root@your-server-ip
   ```

2. **å®‰è£…å¿…è¦è½¯ä»¶**
   ```bash
   # æ›´æ–°ç³»ç»Ÿ
   apt update && apt upgrade -y
   
   # å®‰è£…Node.js
   curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
   apt-get install -y nodejs
   
   # å®‰è£…PM2
   npm install -g pm2
   
   # å®‰è£…Nginx
   apt install nginx -y
   
   # å®‰è£…PostgreSQL
   apt install postgresql postgresql-contrib -y
   ```

3. **é…ç½®PostgreSQL**
   ```bash
   sudo -u postgres psql
   CREATE DATABASE blog_db;
   CREATE USER blog_user WITH ENCRYPTED PASSWORD 'your_password';
   GRANT ALL PRIVILEGES ON DATABASE blog_db TO blog_user;
   \q
   ```

4. **éƒ¨ç½²åç«¯**
   ```bash
   # å…‹éš†ä»£ç 
   git clone https://github.com/your-username/your-blog-repo.git
   cd your-blog-repo/backend
   
   # å®‰è£…ä¾èµ–
   npm install
   
   # åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
   cp env.example .env
   # ç¼–è¾‘.envæ–‡ä»¶ï¼Œè®¾ç½®æ­£ç¡®çš„æ•°æ®åº“è¿æ¥ç­‰ä¿¡æ¯
   
   # æ„å»ºé¡¹ç›®
   npm run build
   
   # è¿è¡Œæ•°æ®åº“è¿ç§»
   npm run db:migrate
   
   # ä½¿ç”¨PM2å¯åŠ¨
   pm2 start dist/index.js --name "blog-backend"
   pm2 save
   pm2 startup
   ```

5. **éƒ¨ç½²å‰ç«¯**
   ```bash
   cd ../frontend
   
   # å®‰è£…ä¾èµ–
   npm install
   
   # åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
   cp env.example .env.local
   # ç¼–è¾‘.env.localæ–‡ä»¶
   
   # æ„å»ºé¡¹ç›®
   npm run build
   
   # ä½¿ç”¨PM2å¯åŠ¨
   pm2 start npm --name "blog-frontend" -- start
   ```

6. **é…ç½®Nginx**
   ```bash
   # åˆ›å»ºé…ç½®æ–‡ä»¶
   nano /etc/nginx/sites-available/blog
   ```
   
   æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š
   ```nginx
   server {
       listen 80;
       server_name your-domain.com;
   
       # å‰ç«¯
       location / {
           proxy_pass http://localhost:3000;
           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection 'upgrade';
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
           proxy_cache_bypass $http_upgrade;
       }
   
       # åç«¯API
       location /api {
           proxy_pass http://localhost:8000;
           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection 'upgrade';
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
           proxy_cache_bypass $http_upgrade;
       }
   }
   ```
   
   ```bash
   # å¯ç”¨é…ç½®
   ln -s /etc/nginx/sites-available/blog /etc/nginx/sites-enabled/
   nginx -t
   systemctl reload nginx
   ```

7. **é…ç½®SSLè¯ä¹¦ï¼ˆä½¿ç”¨Certbotï¼‰**
   ```bash
   apt install certbot python3-certbot-nginx -y
   certbot --nginx -d your-domain.com
   ```

---

## ğŸ”§ é…ç½®åŸŸå

### å¦‚æœä½¿ç”¨Vercelå’ŒRailwayï¼š

1. **è®¾ç½®è‡ªå®šä¹‰åŸŸåï¼ˆVercelï¼‰**
   - åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ è‡ªå®šä¹‰åŸŸå
   - é…ç½®DNSè®°å½•æŒ‡å‘Vercel

2. **è®¾ç½®åç«¯åŸŸåï¼ˆRailwayï¼‰**
   - åœ¨Railwayé¡¹ç›®è®¾ç½®ä¸­é…ç½®è‡ªå®šä¹‰åŸŸå
   - æˆ–ä½¿ç”¨Railwayæä¾›çš„é»˜è®¤åŸŸå

### DNSè®°å½•é…ç½®ç¤ºä¾‹ï¼š
```
ç±»å‹    åç§°        å€¼
A       @          Vercel IP
CNAME   www        your-domain.vercel.app
CNAME   api        your-backend.railway.app
```

---

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### 1. è®¾ç½®ç›‘æ§
- **Uptimeç›‘æ§**: [UptimeRobot](https://uptimerobot.com)
- **é”™è¯¯ç›‘æ§**: [Sentry](https://sentry.io)
- **åˆ†æå·¥å…·**: Google Analytics æˆ– [Umami](https://umami.is)

### 2. å¤‡ä»½ç­–ç•¥
- **æ•°æ®åº“å¤‡ä»½**: Railwayè‡ªåŠ¨å¤‡ä»½æˆ–è®¾ç½®å®šæœŸå¤‡ä»½
- **ä»£ç å¤‡ä»½**: Gitä»“åº“å·²ç»æ˜¯å¤‡ä»½

### 3. æ›´æ–°éƒ¨ç½²
```bash
# æœ¬åœ°æ¨é€ä»£ç 
git push origin main

# Vercelå’ŒRailwayä¼šè‡ªåŠ¨éƒ¨ç½²
# VPSéœ€è¦æ‰‹åŠ¨æ›´æ–°ï¼š
git pull origin main
npm install
npm run build
pm2 restart all
```

---

## ğŸ›¡ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡å®‰å…¨**
   - ç¡®ä¿æ‰€æœ‰å¯†é’¥éƒ½é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®
   - ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥

2. **æ•°æ®åº“å®‰å…¨**
   - ä½¿ç”¨å¼ºå¯†ç 
   - é™åˆ¶æ•°æ®åº“è®¿é—®æƒé™

3. **æœåŠ¡å™¨å®‰å…¨**ï¼ˆVPSéƒ¨ç½²ï¼‰
   - é…ç½®é˜²ç«å¢™
   - å®šæœŸæ›´æ–°ç³»ç»Ÿ
   - ä½¿ç”¨SSHå¯†é’¥è€Œéå¯†ç 

4. **åº”ç”¨å®‰å…¨**
   - å¯ç”¨HTTPS
   - é…ç½®CORSæ­£ç¡®
   - å®æ–½é€Ÿç‡é™åˆ¶

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜ï¼š

1. **éƒ¨ç½²å¤±è´¥**
   - æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®
   - æŸ¥çœ‹æ„å»ºæ—¥å¿—

2. **æ•°æ®åº“è¿æ¥é”™è¯¯**
   - éªŒè¯DATABASE_URLæ ¼å¼
   - ç¡®ä¿æ•°æ®åº“æœåŠ¡æ­£åœ¨è¿è¡Œ

3. **CORSé”™è¯¯**
   - æ£€æŸ¥FRONTEND_URLç¯å¢ƒå˜é‡
   - ç¡®ä¿åŸŸåé…ç½®æ­£ç¡®

4. **404é”™è¯¯**
   - æ£€æŸ¥APIç«¯ç‚¹æ˜¯å¦æ­£ç¡®
   - éªŒè¯è·¯ç”±é…ç½®

### è°ƒè¯•å‘½ä»¤ï¼š
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼ˆRailwayï¼‰
railway logs

# æŸ¥çœ‹PM2æ—¥å¿—ï¼ˆVPSï¼‰
pm2 logs

# æ£€æŸ¥NginxçŠ¶æ€
systemctl status nginx

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
tail -f /var/log/nginx/error.log
```

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š[Vercel Docs](https://vercel.com/docs), [Railway Docs](https://docs.railway.app)
2. æ£€æŸ¥GitHub Issues
3. è”ç³»æŠ€æœ¯æ”¯æŒ

éƒ¨ç½²æˆåŠŸåï¼Œä½ çš„åšå®¢å°±å¯ä»¥åœ¨å…¨ä¸–ç•Œè®¿é—®äº†ï¼ğŸ‰ 